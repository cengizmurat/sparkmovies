{"paragraphs":[{"text":"import scala.util.parsing.json.JSON\nimport org.apache.spark.SparkContext\nimport org.apache.spark.SparkConf\nimport scala.math._\n\ncase class Feels(\n                   id: String,\n                   positivity: String,\n                   subjectivity: String\n                )\n\ncase class Movie(\n                    id: String,\n                    title: String,\n                    rating: String,\n                    release: String,\n                    author: String,\n                    actors: Seq[String],\n                    genres: Seq[String],\n                    country: String,\n                    reviews: Int\n                    //feels: Option[Feels]\n                )\n\ndef parseJSON(s: String): Map[String, Any] = JSON.parseFull(s).get.asInstanceOf[Map[String, Any]]\n\ndef parseMovie(s : String) : Movie =  {\n    val json = parseJSON(s)\n    val id = json.getOrElse(\"id\", 0).toString\n    val title = json.getOrElse(\"title\", \"\").toString\n    val rating = json.getOrElse(\"rating\", 0.0).toString\n    val release = json.getOrElse(\"release\", 1).toString\n    val author = json.getOrElse(\"author\", \"\").toString\n    val actors = json.getOrElse(\"actors\", Seq(\"\")).asInstanceOf[Seq[String]]\n    val genres = json.getOrElse(\"genres\", Seq(\"\")).asInstanceOf[Seq[String]]\n    val country = json.getOrElse(\"country\", \"\").toString\n    val reviews = json.getOrElse(\"reviews\", Seq(\"\")).asInstanceOf[Seq[String]].size\n    Movie(\n      id,\n      title,\n      rating,\n      release,\n      author,\n      actors,\n      genres,\n      country,\n      reviews\n    )\n}\n\ndef parseFeel(s : String) : Feels = {\n    val json = parseJSON(s)\n    val id = json.getOrElse(\"id\", 0).toString\n    val positivity = json.getOrElse(\"positivity\", 0.0).toString\n    val subjectivity = json.getOrElse(\"subjectivity\", 0.0).toString\n    Feels(\n        id,\n        positivity,\n        subjectivity)\n}\n\nval path1 = \"/home/muratcengiz/Documents/spark/sparkmovies/data/movies.txt\"\nval moviesRDD = sc.textFile(path1)\nval movies = moviesRDD.map(parseMovie)\nmovies.toDF().registerTempTable(\"movies\")\n\nval path2 = \"/home/muratcengiz/Documents/spark/sparkmovies/data/feels.txt\"\nval feelsRDD = sc.textFile(path2)\nval feels = feelsRDD.map(parseFeel)\nfeels.toDF().registerTempTable(\"feels\")","user":"anonymous","dateUpdated":"2017-07-11T04:53:47+0200","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1499710469368_-429902698","id":"20170710-201429_509200812","dateCreated":"2017-07-10T20:14:29+0200","dateStarted":"2017-07-11T04:53:48+0200","dateFinished":"2017-07-11T04:54:05+0200","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:448","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\nimport scala.util.parsing.json.JSON\n\nimport org.apache.spark.SparkContext\n\nimport org.apache.spark.SparkConf\n\nimport scala.math._\n\ndefined class Feels\n\ndefined class Movie\n\nparseJSON: (s: String)Map[String,Any]\n\nparseMovie: (s: String)Movie\n\nparseFeel: (s: String)Feels\n\npath1: String = /home/muratcengiz/Documents/spark/sparkmovies/data/movies.txt\n\nmoviesRDD: org.apache.spark.rdd.RDD[String] = /home/muratcengiz/Documents/spark/sparkmovies/data/movies.txt MapPartitionsRDD[383] at textFile at <console>:203\n\nmovies: org.apache.spark.rdd.RDD[Movie] = MapPartitionsRDD[384] at map at <console>:211\n\nwarning: there was one deprecation warning; re-run with -deprecation for details\n\npath2: String = /home/muratcengiz/Documents/spark/sparkmovies/data/feels.txt\n\nfeelsRDD: org.apache.spark.rdd.RDD[String] = /home/muratcengiz/Documents/spark/sparkmovies/data/feels.txt MapPartitionsRDD[387] at textFile at <console>:203\n\nfeels: org.apache.spark.rdd.RDD[Feels] = MapPartitionsRDD[388] at map at <console>:211\n\nwarning: there was one deprecation warning; re-run with -deprecation for details\n"}]}},{"text":"%sql \nselect release, id\nfrom movies\norder by release","user":"anonymous","dateUpdated":"2017-07-11T04:52:00+0200","config":{"colWidth":12,"enabled":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":true,"setting":{"multiBarChart":{}},"commonSetting":{},"keys":[{"name":"release","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"release","index":0,"aggr":"count"}]},"helium":{}}},"editorSetting":{"language":"sql"},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"release\tid\n1931.0\t2256.0\n1936.0\t1832.0\n1945.0\t2253.0\n1951.0\t836.0\n1956.0\t4963.0\n1957.0\t4063.0\n1960.0\t3227.0\n1960.0\t1603.0\n1968.0\t19395.0\n1969.0\t2021.0\n1972.0\t1628.0\n1975.0\t4499.0\n1975.0\t28201.0\n1976.0\t2072.0\n1977.0\t25801.0\n1979.0\t29714.0\n1979.0\t27061.0\n1979.0\t62.0\n1980.0\t863.0\n1980.0\t25802.0\n1981.0\t121.0\n1983.0\t25803.0\n1984.0\t1941.0\n1985.0\t448.0\n1987.0\t2749.0\n1989.0\t5032.0\n1990.0\t5969.0\n1991.0\t6641.0\n1991.0\t27624.0\n1992.0\t7524.0\n1994.0\t10126.0\n1994.0\t10568.0\n1994.0\t9684.0\n1994.0\t10862.0\n1994.0\t9393.0\n1995.0\t12837.0\n1995.0\t11736.0\n1996.0\t10251.0\n1996.0\t13892.0\n1998.0\t64439.0\n1998.0\t18598.0\n1999.0\t19776.0\n1999.0\t21189.0\n1999.0\t12475.0\n2000.0\t73176.0\n2000.0\t24944.0\n2000.0\t22779.0\n2001.0\t27070.0\n2002.0\t39186.0\n2002.0\t37485.0\n2002.0\t28359.0\n2003.0\t39187.0\n2005.0\t56714.0\n2007.0\t27606.0\n2008.0\t115362.0\n2009.0\t135063.0\n2010.0\t143692.0\n2010.0\t123534.0\n2010.0\t132039.0\n2010.0\t126123.0\n2011.0\t179349.0\n2011.0\t176673.0\n2011.0\t182745.0\n2011.0\t175305.0\n2011.0\t138673.0\n2012.0\t132874.0\n2012.0\t206736.0\n2013.0\t195370.0\n2013.0\t180887.0\n2013.0\t182120.0\n2013.0\t190918.0\n2013.0\t197436.0\n2013.0\t216955.0\n2014.0\t218926.0\n2014.0\t196885.0\n2014.0\t137097.0\n2014.0\t114782.0\n2014.0\t223002.0\n2014.0\t173271.0\n2014.0\t217882.0\n2014.0\t226004.0\n2014.0\t181290.0\n2014.0\t225953.0\n2015.0\t228825.0\n2015.0\t239723.0\n2015.0\t189077.0\n2015.0\t196960.0\n2015.0\t198371.0\n2015.0\t197685.0\n2015.0\t230045.0\n2016.0\t249877.0\n2016.0\t236155.0\n2016.0\t236415.0\n2016.0\t208104.0\n2016.0\t240944.0\n2016.0\t241697.0\n2016.0\t223207.0\n2016.0\t227320.0\n2016.0\t230327.0\n2016.0\t228533.0\n2016.0\t228263.0\n2016.0\t231299.0\n2016.0\t213641.0\n2017.0\t245983.0\n2017.0\t229490.0\n2017.0\t229070.0\n2017.0\t241763.0\n2017.0\t219070.0\n"}]},"apps":[],"jobName":"paragraph_1499710732163_1725443671","id":"20170710-201852_2089891989","dateCreated":"2017-07-10T20:18:52+0200","dateStarted":"2017-07-11T04:48:34+0200","dateFinished":"2017-07-11T04:49:20+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:449"},{"text":"%sql\nselect positivity, release\nfrom movies\njoin feels on movies.id = feels.id\norder by release","user":"anonymous","dateUpdated":"2017-07-11T04:55:19+0200","config":{"colWidth":12,"enabled":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":true,"setting":{"multiBarChart":{}},"commonSetting":{},"keys":[{"name":"release","index":1,"aggr":"sum"}],"groups":[],"values":[{"name":"positivity","index":0,"aggr":"avg"}]},"helium":{}}},"editorSetting":{"language":"sql"},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1499715658311_-643741377","id":"20170710-214058_1297871589","dateCreated":"2017-07-10T21:40:58+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:450","dateFinished":"2017-07-11T04:55:07+0200","dateStarted":"2017-07-11T04:54:13+0200","results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"positivity\trelease\n0.24586433707588218\t1931.0\n0.27002370146451793\t1936.0\n0.18745459384243424\t1945.0\n0.17755275686781866\t1951.0\n0.13253702052981078\t1956.0\n0.20825643404179617\t1957.0\n0.18388316570678556\t1960.0\n0.24374571545919585\t1960.0\n0.2782752231427945\t1968.0\n0.2629654262112085\t1969.0\n0.2294002679305285\t1972.0\n0.2517359094397626\t1975.0\n0.1894146475727502\t1975.0\n0.20608239313778223\t1976.0\n0.23147403534815125\t1977.0\n0.14506764484745768\t1979.0\n0.15240290719466792\t1979.0\n0.14958516118519705\t1979.0\n0.21642469131164038\t1980.0\n0.1098165186888631\t1980.0\n0.2554672037021329\t1981.0\n0.1968010020462101\t1983.0\n0.2515492374460986\t1984.0\n0.27070806403950953\t1985.0\n0.1603108486667619\t1987.0\n0.247398591998189\t1989.0\n0.21941149092128118\t1990.0\n0.17017627859491363\t1991.0\n0.27342107809795557\t1991.0\n0.19637471332703701\t1992.0\n0.2792679314501656\t1994.0\n0.23920963720513436\t1994.0\n0.20892787459807477\t1994.0\n0.17040006916134484\t1994.0\n0.29264152497119383\t1994.0\n0.15951385738431484\t1995.0\n0.29122880032546555\t1995.0\n0.1391936958107354\t1996.0\n0.19036523623688764\t1996.0\n0.22467377617518394\t1998.0\n0.19564612741637666\t1998.0\n0.23720248010300027\t1999.0\n0.15397193355356037\t1999.0\n0.15010706555290682\t1999.0\n0.24410538514096056\t2000.0\n0.29816547701267876\t2000.0\n0.257921916944556\t2000.0\n0.30644444966558804\t2001.0\n0.2554765374765059\t2002.0\n0.21004019827654394\t2002.0\n0.243790372757993\t2002.0\n0.2263130484972063\t2003.0\n0.22177348924339305\t2005.0\n0.13887340852660124\t2007.0\n0.20548484078637452\t2008.0\n0.2003448463065433\t2009.0\n0.17402889954010212\t2010.0\n0.2277455824945943\t2010.0\n0.20278996640967942\t2010.0\n0.29847384483198336\t2010.0\n0.26685170740837477\t2011.0\n0.14225467468305203\t2011.0\n0.13079673622621377\t2011.0\n0.23344058826469657\t2011.0\n0.2089970667614589\t2011.0\n0.11437851037111782\t2012.0\n0.26770844702375274\t2012.0\n0.17230728427163\t2013.0\n0.13490699191818542\t2013.0\n0.1587862971827603\t2013.0\n0.24461264358253895\t2013.0\n0.16345273704789837\t2013.0\n0.21952188017890592\t2013.0\n0.08892752039891727\t2014.0\n0.18275873760135206\t2014.0\n0.2315422490236369\t2014.0\n0.13914852196799563\t2014.0\n0.12160055931032872\t2014.0\n0.22163388902720346\t2014.0\n0.24104194271911664\t2014.0\n0.11549617493668622\t2014.0\n0.2206497442943056\t2014.0\n0.051435268730592405\t2014.0\n0.17075012274243045\t2015.0\n0.3670407785722392\t2015.0\n0.21240771008181067\t2015.0\n0.22137510889299042\t2015.0\n0.18691857154357316\t2015.0\n0.1926483987000432\t2015.0\n0.2586417421614359\t2015.0\n0.21062059594849208\t2016.0\n0.25504802026664614\t2016.0\n0.27893132597483633\t2016.0\n0.2546526632835733\t2016.0\n0.20975780888474133\t2016.0\n0.20346322583162818\t2016.0\n0.2252808251166228\t2016.0\n0.21130897703917698\t2016.0\n0.30577156466602307\t2016.0\n0.24491730600200728\t2016.0\n0.27711789524831326\t2016.0\n0.1470595251611157\t2016.0\n0.16365817130826454\t2016.0\n0.22279185566405577\t2017.0\n0.18942348355072863\t2017.0\n0.22879962786451855\t2017.0\n0.22993713238798202\t2017.0\n0.2651778711311886\t2017.0\n"}]}},{"text":"%sql\nselect rating, release\nfrom movies\norder by release","user":"anonymous","dateUpdated":"2017-07-11T05:02:19+0200","config":{"colWidth":12,"enabled":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":true,"setting":{"multiBarChart":{},"pieChart":{}},"commonSetting":{},"keys":[{"name":"release","index":1,"aggr":"sum"}],"groups":[],"values":[{"name":"rating","index":0,"aggr":"avg"}]},"helium":{}}},"editorSetting":{"language":"sql"},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1499739431019_1438025558","id":"20170711-041711_30469239","dateCreated":"2017-07-11T04:17:11+0200","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:2086","dateFinished":"2017-07-11T04:58:44+0200","dateStarted":"2017-07-11T04:57:55+0200","results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"rating\trelease\n4.3\t1931.0\n4.4\t1936.0\n4.4\t1945.0\n4.4\t1951.0\n4.3\t1956.0\n4.5\t1957.0\n4.4\t1960.0\n4.3\t1960.0\n4.4\t1968.0\n4.4\t1969.0\n4.5\t1972.0\n4.3\t1975.0\n4.4\t1975.0\n4.5\t1976.0\n4.4\t1977.0\n4.3\t1979.0\n4.3\t1979.0\n4.3\t1979.0\n4.4\t1980.0\n4.3\t1980.0\n4.3\t1981.0\n4.4\t1983.0\n4.4\t1984.0\n4.4\t1985.0\n4.3\t1987.0\n4.3\t1989.0\n4.4\t1990.0\n4.4\t1991.0\n4.4\t1991.0\n4.3\t1992.0\n4.6\t1994.0\n4.5\t1994.0\n4.5\t1994.0\n4.5\t1994.0\n4.3\t1994.0\n4.4\t1995.0\n4.5\t1995.0\n4.4\t1996.0\n4.4\t1996.0\n4.4\t1998.0\n4.3\t1998.0\n4.3\t1999.0\n4.4\t1999.0\n4.5\t1999.0\n4.3\t2000.0\n4.6\t2000.0\n4.5\t2000.0\n4.5\t2001.0\n4.5\t2002.0\n4.3\t2002.0\n4.3\t2002.0\n4.5\t2003.0\n4.4\t2005.0\n4.3\t2007.0\n4.5\t2008.0\n4.5\t2009.0\n4.3\t2010.0\n4.5\t2010.0\n4.4\t2010.0\n4.4\t2010.0\n4.3\t2011.0\n4.5\t2011.0\n4.4\t2011.0\n4.4\t2011.0\n4.4\t2011.0\n4.3\t2012.0\n4.5\t2012.0\n4.4\t2013.0\n4.3\t2013.0\n4.4\t2013.0\n4.3\t2013.0\n4.4\t2013.0\n4.5\t2013.0\n4.3\t2014.0\n4.5\t2014.0\n4.3\t2014.0\n4.4\t2014.0\n4.4\t2014.0\n4.5\t2014.0\n4.4\t2014.0\n4.5\t2014.0\n4.4\t2014.0\n4.3\t2014.0\n4.4\t2015.0\n4.3\t2015.0\n4.4\t2015.0\n4.3\t2015.0\n4.3\t2015.0\n4.3\t2015.0\n4.3\t2015.0\n4.4\t2016.0\n4.5\t2016.0\n4.4\t2016.0\n4.3\t2016.0\n4.5\t2016.0\n4.4\t2016.0\n4.4\t2016.0\n4.4\t2016.0\n4.3\t2016.0\n4.4\t2016.0\n4.3\t2016.0\n4.4\t2016.0\n4.3\t2016.0\n4.5\t2017.0\n4.4\t2017.0\n4.4\t2017.0\n4.4\t2017.0\n4.4\t2017.0\n"}]}},{"text":"%sql\n","user":"anonymous","dateUpdated":"2017-07-11T04:27:18+0200","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"sql"},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1499740038235_-1789611063","id":"20170711-042718_1937212081","dateCreated":"2017-07-11T04:27:18+0200","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:2674"}],"name":"zeppelin_scala","id":"2CPZ8UKRM","angularObjects":{"2CPBFSWN4:shared_process":[],"2CMWXUFHZ:shared_process":[],"2CPTG68TK:shared_process":[],"2CPV8C8N1:shared_process":[],"2CMFEWHPJ:shared_process":[],"2CMHPU2A6:shared_process":[],"2CQBGYBHV:shared_process":[],"2CQ3YPTVY:shared_process":[],"2CMJVQV61:shared_process":[],"2CP8WM288:shared_process":[],"2CNQWHPJ2:shared_process":[],"2CQ9HSUWP:shared_process":[],"2CNCDZY41:shared_process":[],"2CPZS44RB:shared_process":[],"2CQCVH4RQ:shared_process":[],"2CM1J4FUN:shared_process":[],"2CKS5ZWMG:shared_process":[],"2CNEKH2DB:shared_process":[],"2CNRAWUBX:shared_process":[]},"config":{"looknfeel":"default","personalizedMode":"false"},"info":{}}